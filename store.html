<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Store • Gauri Creations</title>

<style>
    body {
        margin: 0;
        font-family: "Poppins", sans-serif;
        background: #f7f7f7;
        padding: 15px;
    }

    h1 {
        text-align: center;
        margin-bottom: 10px;
        font-size: 26px;
        font-weight: bold;
    }

    /* Filter Box */
    .filters {
        background: white;
        padding: 12px;
        border-radius: 14px;
        margin-bottom: 15px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .filters input,
    .filters select {
        width: 100%;
        padding: 10px;
        border-radius: 10px;
        border: 1px solid #ccc;
        margin-top: 8px;
        font-size: 15px;
    }

    .filter-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 10px;
    }

    /* Product Grid */
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: 15px;
    }

    /* Product Card */
    .product-card {
        background: white;
        padding: 12px;
        border-radius: 14px;
        box-shadow: 0 5px 14px rgba(0,0,0,0.12);
        cursor: pointer;
        perspective: 900px; /* enables 3D */
    }

    /* Inner wrapper for 3D tilt */
    .product-inner {
        background: white;
        border-radius: 14px;
        transition: transform 0.25s ease; /* smooth 3D */
    }

    /* Image zoom */
    .product-img {
        width: 100%;
        height: 150px;
        object-fit: cover;
        border-radius: 12px;
        transition: transform 0.35s ease;
    }

    .product-card:hover .product-img {
        transform: scale(1.15);
    }

    .product-name {
        font-size: 15px;
        font-weight: 600;
        margin: 8px 0 4px;
    }

    .product-price {
        font-size: 16px;
        font-weight: bold;
        color: #e53935;
    }

    /* QUICK VIEW POPUP */
    .popup-overlay {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0,0,0,0.55);
        display: none;
        align-items: center;
        justify-content: center;
        animation: fadeIn 0.2s;
        z-index: 2000;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to   { opacity: 1; }
    }

    .popup-box {
        width: 90%;
        max-width: 420px;
        background: white;
        border-radius: 16px;
        padding: 16px;
        animation: slideUp 0.25s ease;
        position: relative;
    }

    @keyframes slideUp {
        from { transform: translateY(20px); opacity: 0; }
        to   { transform: translateY(0); opacity: 1; }
    }

    .popup-close {
        position: absolute;
        top: 10px;
        right: 14px;
        font-size: 26px;
        font-weight: bold;
        cursor: pointer;
        color: #333;
    }

    .popup-main-img {
        width: 100%;
        height: 220px;
        object-fit: cover;
        border-radius: 12px;
        margin-bottom: 10px;
    }

    .popup-gallery {
        display: flex;
        gap: 8px;
        margin-bottom: 12px;
    }

    .popup-thumb {
        width: 70px;
        height: 70px;
        object-fit: cover;
        border-radius: 10px;
        border: 2px solid transparent;
        cursor: pointer;
    }

    .popup-thumb:hover {
        border-color: #007aff;
    }

    .popup-title {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 6px;
    }

    .popup-price {
        font-size: 19px;
        font-weight: bold;
        color: #e53935;
        margin-bottom: 8px;
    }

    .popup-desc {
        font-size: 14px;
        color: #444;
        margin-bottom: 12px;
        line-height: 1.4;
    }

    .popup-specs {
        background: #f1f1f1;
        padding: 10px;
        border-radius: 12px;
        margin-bottom: 14px;
        font-size: 14px;
    }

    .btn-buy-big {
        display: block;
        width: 100%;
        padding: 12px;
        text-align: center;
        background: #007aff;
        color: white;
        font-weight: 600;
        border-radius: 14px;
        text-decoration: none;
        margin-top: 10px;
    }
</style>
</head>

<body>

<h1>Our Products</h1>

<!-- FILTERS -->
<div class="filters">
    <input type="text" id="searchBar" placeholder="Search products...">

    <div class="filter-row">
        <select id="categoryFilter">
            <option value="">All Categories</option>
        </select>

        <select id="sortFilter">
            <option value="">Sort By</option>
            <option value="low">Price: Low to High</option>
            <option value="high">Price: High to Low</option>
        </select>
    </div>

    <div class="filter-row">
        <input type="number" id="minPrice" placeholder="Min Price">
        <input type="number" id="maxPrice" placeholder="Max Price">
    </div>
</div>

<!-- PRODUCTS GRID -->
<div id="productGrid" class="grid"></div>

<!-- QUICK VIEW POPUP -->
<div id="popup" class="popup-overlay">
    <div class="popup-box">
        <div class="popup-close" onclick="closePopup()">×</div>

        <img id="popupMainImg" class="popup-main-img">

        <div id="popupGallery" class="popup-gallery"></div>

        <div class="popup-title" id="popupName"></div>
        <div class="popup-price" id="popupPrice"></div>
        <div class="popup-desc" id="popupDesc"></div>

        <div class="popup-specs" id="popupSpecs"></div>

        <a id="popupBuyBtn" class="btn-buy-big">Buy Now</a>
    </div>
</div>

<script>
/* Your Apps Script URL */
const API_URL = "PUT-YOUR-DEPLOYMENT-URL-HERE";

let PRODUCTS = [];

/* LOAD PRODUCTS */
async function loadProducts() {
    const res = await fetch(API_URL + "?getProducts=1");
    const data = await res.json();
    PRODUCTS = data.products || [];

    populateCategories();
    displayProducts(PRODUCTS);
}

/* CATEGORY DROPDOWN */
function populateCategories() {
    const catBox = document.getElementById("categoryFilter");
    const cats = [...new Set(PRODUCTS.map(p => p.Category).filter(Boolean))];

    cats.forEach(cat => {
        let opt = document.createElement("option");
        opt.value = cat;
        opt.textContent = cat;
        catBox.appendChild(opt);
    });
}

/* DISPLAY PRODUCTS */
function displayProducts(list) {
    const grid = document.getElementById("productGrid");
    grid.innerHTML = "";

    list.forEach(p => {
        const card = document.createElement("div");
        card.className = "product-card";

        // Inner wrapper for tilt
        const inner = document.createElement("div");
        inner.className = "product-inner";

        inner.innerHTML = `
            <img src="${p.Image1}" class="product-img">
            <div class="product-name">${p.Name}</div>
            <div class="product-price">₹${p.Price}</div>
        `;

        /* --- 3D Tilt Effect --- */
        card.addEventListener("mousemove", (e) => {
            const rect = card.getBoundingClientRect();
            const x = e.clientX - rect.left - rect.width / 2;
            const y = e.clientY - rect.top - rect.height / 2;

            inner.style.transform = `rotateY(${x/20}deg) rotateX(${-y/20}deg)`;
        });

        card.addEventListener("mouseleave", () => {
            inner.style.transform = "rotateY(0deg) rotateX(0deg)";
        });

        card.appendChild(inner);

        card.onclick = () => openPopup(p);

        grid.appendChild(card);
    });
}

/* POPUP */
function openPopup(p) {
    document.getElementById("popup").style.display = "flex";
    document.getElementById("popupMainImg").src = p.Image1;

    const gallery = document.getElementById("popupGallery");
    gallery.innerHTML = "";

    [p.Image1, p.Image2, p.Image3].forEach(img => {
        if (!img) return;
        const thumb = document.createElement("img");
        thumb.className = "popup-thumb";
        thumb.src = img;
        thumb.onclick = () => {
            document.getElementById("popupMainImg").src = img;
        };
        gallery.appendChild(thumb);
    });

    document.getElementById("popupName").textContent = p.Name;
    document.getElementById("popupPrice").textContent = "₹" + p.Price;
    document.getElementById("popupDesc").textContent = p.Description;

    document.getElementById("popupSpecs").innerHTML = `
        <b>Dimensions:</b> ${p.Length} × ${p.Width} × ${p.Height} cm<br>
        <b>Weight:</b> ${p.Weight} g
    `;

    document.getElementById("popupBuyBtn").href =
        `order.html?product=${encodeURIComponent(p.Name)}&price=${p.Price}&img=${encodeURIComponent(p.Image1)}`;
}

function closePopup() {
    document.getElementById("popup").style.display = "none";
}

/* FILTERS */
function applyFilters() {
    let list = [...PRODUCTS];

    const search = document.getElementById("searchBar").value.toLowerCase();
    const cat = document.getElementById("categoryFilter").value;
    const sort = document.getElementById("sortFilter").value;
    const min = Number(document.getElementById("minPrice").value);
    const max = Number(document.getElementById("maxPrice").value);

    if (search) list = list.filter(p => p.Name.toLowerCase().includes(search));
    if (cat) list = list.filter(p => p.Category === cat);
    if (min) list = list.filter(p => Number(p.Price) >= min);
    if (max) list = list.filter(p => Number(p.Price) <= max);

    if (sort === "low") list.sort((a,b) => Number(a.Price) - Number(b.Price));
    if (sort === "high") list.sort((a,b) => Number(b.Price) - Number(a.Price));

    displayProducts(list);
}

document.getElementById("searchBar").addEventListener("input", applyFilters);
document.getElementById("categoryFilter").addEventListener("change", applyFilters);
document.getElementById("sortFilter").addEventListener("change", applyFilters);
document.getElementById("minPrice").addEventListener("input", applyFilters);
document.getElementById("maxPrice").addEventListener("input", applyFilters);

loadProducts();
</script>
</body>
</html>
